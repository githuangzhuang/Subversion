读写分离介绍：把客户端访问数据的查询访问和写入数据的访问分别给不同数据库服务器处理
maxscal 官方下载地址： https://downloads.mariadb.com/files/MaxScale
查看软件管理命令：max(双tab)

1.部署mysql 一主一从，同步结构，A、B
2.部署数据读写分离服务器   C
2.1 装包
  修改配置文件
3. 在主服务器根据配置设置添加对应的用户   
4. 启动读写分离服务
5. 客户端验证数据读写分离服务
	
	1.rpm -ivh maxscal...rpm
	
	2. cp /etc/maxscal.cnf{,.bak}
	   vim /etc/maxscal.cnf
		threads=auto                    根据系统cpu核数配置多少线程数
		   ....
		[server1]				指定数据库服务器的ip
		type=server
		address=主服务器ip
		port=3306
		protocol=MySQLBackend
		
		[server2]				复制上面修改ip
		   .....
		address=从服务器ip
		   .....

		[MySQL Monitor]			定义监视的数据库服务器
		   ...
		servers=server1, server2
		user=监视授权用户名			主服务器授权用户			
		passwd=密码
		
		#[Read-Only Service]		只允许某台服务器查看注释掉
		#type=service
		#router=readconnroute
		#servers=server1
		#user=myuser
		#passwd=mypwd
		#router_options=slave

		[Read-Write Service]		定义读写分离服务
		servers=server1, server2
		user=验证授权用户
		passwd=密码

		#[Read-Only Listener]		只允许某台服务器监听注释掉
		#type=listener
		#service=Read-Only Service
		#protocol=MySQLClient
		#port=4006

		[MaxAdmin Listener]      	定义管理服务定义的端口号
		...
		port=4026

		3.grant replication slave,replication client on *.* to myuser@'%' identified by "123456";
		  grant select on mysql.* to 验证授权用户@'%' identified by "123456";

		4. maxscale -f /etc/maxscale.cnf
		   netstat -anputl | grep maxscale
		   kiallall -9 maxscale     停止服务    
		   maxadmin -uadmin -pmariadb -P4026          进入maxscale服务
			list servers        查看服务

		5.mysql -h192.168.4.57  -P4006 -uyaya -p123456


多实列配置
1.安装支持多实列服务的软件包
2.修改主配置文件，把原来的/etc/my.cnf移走，重新写配置
3.初始化授权库
4.启动服务
5.客户端访问测试
	1.yum -y install gcc gcc-c++
	  tar -xf mysql-5.7.20...tar

	2.vim /etc/my.c
	[mysqld_multi]
	mysqld = /usr/local/mysql/bin/mysqld_safe
	mysqldadmin = /usr/local/mysql/bin/mysqladmin
	user = root
	
	[mysqld1]
	datadir=/data3307
	port=3307
	log-error=/data3307/mysqld3307.log
	pid-file=/data3307/mysqld3307.pid
	socket=/data3307/mysqld3307.socket

	[mysqld2]
	datadir=/data3308
	port=3308
	log-error=/data3308/mysqld3308.log
	pid-file=/data3308/mysqld3308.pid
	socket=/data3308/mysqld3308.socket

创建目录定义好的目录：
	mkdir /data3307 /data3308

	3.usr/local/mysql/bin/mysqld_multi start 1
使用初始密码登入：
	/usr/local/mysql/bin/mysql -uroot -p原始密码 -S /data3307/mysql3307.socket
修改密码：
	alter user root@localhost identified by "新密码";

第二台初始化：
	usr/local/mysql/bin/mysqld_multi start 2

把之前的/bin/mysql删掉，重新建软连接
	ln -s /usr/local/mysql/bin/mysql /bin 

排错解决：
	删除目录，重新创建，killall -9 进程，再初始化

